<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<!--Lua Codehightlight--><link href="prism.css" rel="stylesheet" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Binding of Isaac - Afterbirth+ Lua Reference/Guide: Remarks</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Binding of Isaac - Afterbirth+ Lua Reference/Guide
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('tutorial','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Using additional .lua Files </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock">
    <p>If you want to load an additional .lua file besides your main.lua file, you can use the "require" function. </p>
    <p><b>Note:</b> Reloading a mod that uses this method of loading additional files using the command "luamod" will not load the extra files correctly.</p>
    <h4>Content "secondFile.lua":</h4>
    <pre><code class="language-lua">x = "Hello world" --define a new global variable x</pre></code>
    <h4>Content "main.lua":</h4>
    <pre><code class="language-lua">require("secondFile")
print(x)</pre></code>
    <h4>This prints:</h4>
    <pre><code class="language-lua">"Hello world"</pre></code>
    
    
    <h2>Navigate into folders:</h2>
    You can navigate into folders, by seperating the path with a "."
    <h4>Content "folder1/folder2/secondFile.lua":</h4>
    <pre><code class="language-lua">x = "Hello world" --define a new global variable x</pre></code>
    <h4>Content "main.lua":</h4>
    <pre><code class="language-lua">require("folder1.folder2.secondFile")
print(x)</pre></code>
    <h4>This prints:</h4>
    <pre><code class="language-lua">"Hello world"</pre></code>
    
    
    
    <h2>Load extra files with "luamod"-command consistency</h2>
    <p>If you want to load additional files the most correct way, you have to intentionally cause an error in the extra file and catch it in the main file. The following code is an example for this method:</p>
    <h4>Content "secondFile.lua":</h4>
    <pre><code class="language-lua">x = "Hello world" --define a new global variable x
--end of the file 
Err:ForceError() --call a nonexistent function to throw an error intentionally
 </pre></code>
    <h4>Content "main.lua":</h4>
    <pre><code class="language-lua">local _, err = pcall(require, "filename")--change filename here
--The following code catches errors and handles them nicely.
err = tostring(err)
if not string.match(err, "attempt to call a nil value %(method 'ForceError'%)") then
    if string.match(err, "true") then
        err = "Error: require passed in config"
    end
    Isaac.DebugString(err)
    print(err)
end
-- end of errorhandling
print(x)</pre></code>
    <h4>This prints:</h4>
    <pre><code class="language-lua">"Hello world"</pre></code>

    <h2>Using Sockets and other general lua-modules</h2>
    
    <p>The following functions/objects are available from within the lua-api:</p>
         <table class="fieldtable">
<thead>
  <tr>
    <th><b>Always Available</b></th>
    <th><b>Only available with <code>--luadebug</code></b></th>
  </tr>
</thead>
<tbody>
  <tr><td>json (with <code>require("json")</code>)</td><td>socket (with <code>require("socket")</code>)</td></tr>
  <tr><td>assert</td>   <td>debug</td></tr>
  <tr><td>collectgarbage</td><td>io</td></tr>
  <tr><td>coroutine</td><td>os</td></tr>
  <tr><td>dofile</td><td>package</td></tr>
  <tr><td>error</td><td>require <b style="color:green">(not modified*)</b></td></tr>
  <tr><td>getmetatable</td><td></td></tr>
  <tr><td>ipairs</td><td></td></tr>
  <tr><td>load</td><td></td></tr>
  <tr><td>loadfile</td><td></td></tr>
  <tr><td>math</td><td></td></tr>
  <tr><td>next</td><td></td></tr>
  <tr><td>pairs</td><td></td></tr>
  <tr><td>pcall</td><td></td></tr>
  <tr><td>print</td><td></td></tr>
  <tr><td>rawequal</td><td></td></tr>
  <tr><td>rawget</td><td></td></tr>
  <tr><td>rawlen</td><td></td></tr>
  <tr><td>rawset</td><td></td></tr>
  <tr><td>require <b style="color:red">(modified*)</b></td><td></td></tr>
  <tr><td>select</td><td></td></tr>
  <tr><td>setmetatable</td><td></td></tr>
  <tr><td>string</td><td></td></tr>
  <tr><td>table</td><td></td></tr>
  <tr><td>tonumber</td><td></td></tr>
  <tr><td>tostring</td><td></td></tr>
  <tr><td>type</td><td></td></tr>
  <tr><td>utf8</td><td></td></tr>
  <tr><td>xpcall</td><td></td></tr>
</tbody>
</table>
    <h3>--luadebug</h3>
    <p><code>--luadebug</code> is an argument that can be defined as a launchparameter of the game. It enables additional and potential harmful features of the lua interpreter. To enable it, navigate in steam to "Library ->  Right click on Isaac -> Preferences -> General -> launchoptions" and then write <code>--luadebug</code> inside the textfield.</p>
    <h4>What it does</h4>
    <p>The flag enables the packages listed on the right side of the table aboth and propably enables the original require function to be called instead of the altered version, which transforms the filepath into a path ending with ".lua".</p>
    <h4>Networking and socket</h4>
    <p>To enable network and socket features, the <code>--luadebug</code> needs to be set. otherwise, the module cant be loaded.</p>
    <h4>Possible problems using --luadebug</h4>
    <p>In general, <code>--luadebug</code> enables all features of the lua language, including extremely harmful features like "os". With that, it is possible to open, write or even delete any file on the system even if it is not related to the game itself.</p>
    <h2>The game's "main.lua" file</h2>
    <p>Inside the "scripts" folder of the game, a unique "main.lua" file can be found which acts independently from the rest of the other mods.</p>
    <p>The file will always the loaded and executed even if the modding api is turned off (at least one mod activated). This allows us to execute lua code even in scenarios its normally not possible, like in daily runs.</p>
    <p>Nice to know: if you use "ModData" inside this "main.lua" file, the "saveX.dat" files get placed next to this file inside the games resources/scripts folder.</p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
<!--Lua Codehightlight--><script src="prism.js"></script>
</body>
</html>
